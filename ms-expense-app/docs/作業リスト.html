<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>çµŒè²»ç”³è«‹ã‚¢ãƒ—ãƒª ä½œæ¥­ãƒªã‚¹ãƒˆ</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: "Meiryo", "Yu Gothic", sans-serif;
      background: #f0f4f8;
      color: #333;
      padding: 20px;
      max-width: 860px;
      margin: 0 auto;
    }

    h1 {
      text-align: center;
      font-size: 24px;
      margin-bottom: 6px;
      color: #1e3a5f;
    }

    .subtitle {
      text-align: center;
      font-size: 13px;
      color: #888;
      margin-bottom: 24px;
    }

    /* å…¨ä½“é€²æ— */
    .overall-progress {
      background: #fff;
      border-radius: 12px;
      padding: 20px 24px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    .overall-progress h2 { font-size: 16px; margin-bottom: 12px; color: #1e3a5f; }
    .progress-row { display: flex; align-items: center; gap: 12px; margin-bottom: 8px; }
    .progress-label-text { font-size: 13px; color: #555; min-width: 180px; }
    .progress-bar-bg {
      flex: 1;
      background: #e2e8f0;
      border-radius: 999px;
      height: 14px;
      overflow: hidden;
    }
    .progress-bar-fill {
      height: 100%;
      border-radius: 999px;
      transition: width 0.4s ease;
    }
    .bar-done { background: #22c55e; }
    .bar-mid  { background: #3b82f6; }
    .bar-zero { background: #cbd5e1; width: 2px !important; }
    .progress-pct { font-size: 13px; font-weight: bold; min-width: 36px; text-align: right; }

    /* ãƒ•ã‚§ãƒ¼ã‚º */
    .phase { margin-bottom: 24px; }

    .phase-header {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 20px;
      border-radius: 10px 10px 0 0;
      cursor: pointer;
      user-select: none;
    }
    .phase-header:hover { filter: brightness(0.97); }
    .phase-icon { font-size: 20px; }
    .phase-title { font-size: 17px; font-weight: bold; flex: 1; }
    .phase-status {
      font-size: 12px;
      padding: 3px 10px;
      border-radius: 999px;
      font-weight: bold;
    }
    .phase-toggle { font-size: 18px; transition: transform 0.3s; }
    .phase-toggle.closed { transform: rotate(-90deg); }

    .phase-body {
      background: #fff;
      border-radius: 0 0 10px 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.07);
      overflow: hidden;
    }
    .phase-body.collapsed { display: none; }

    .phase-1 .phase-header { background: #dcfce7; color: #166534; }
    .phase-1 .phase-status { background: #166534; color: #fff; }
    .phase-2 .phase-header { background: #dbeafe; color: #1e3a5f; }
    .phase-2 .phase-status { background: #3b82f6; color: #fff; }
    .phase-3 .phase-header { background: #fef9c3; color: #713f12; }
    .phase-3 .phase-status { background: #f59e0b; color: #fff; }
    .phase-4 .phase-header { background: #f3f4f6; color: #374151; }
    .phase-4 .phase-status { background: #9ca3af; color: #fff; }

    /* ã‚¿ã‚¹ã‚¯è¡Œ */
    .task {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 14px 20px;
      border-bottom: 1px solid #f1f5f9;
      transition: background 0.2s;
    }
    .task:last-child { border-bottom: none; }
    .task:hover { background: #f8fafc; }
    .task.completed { background: #f0fdf4; }
    .task.optional { opacity: 0.75; }

    .task-checkbox {
      width: 20px; height: 20px;
      cursor: pointer;
      accent-color: #22c55e;
      flex-shrink: 0;
      margin-top: 2px;
    }
    .task-num {
      font-size: 12px; font-weight: bold;
      color: #3b82f6;
      min-width: 36px;
      padding-top: 2px;
    }
    .task-body { flex: 1; }
    .task-title {
      font-size: 15px; font-weight: bold;
      margin-bottom: 4px;
    }
    .completed .task-title { text-decoration: line-through; color: #999; }
    .task-desc { font-size: 13px; color: #666; line-height: 1.7; }

    .task-badge {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      flex-shrink: 0;
      margin-top: 2px;
    }
    .badge-done     { background: #dcfce7; color: #166534; }
    .badge-todo     { background: #dbeafe; color: #1e3a5f; }
    .badge-optional { background: #f3f4f6; color: #6b7280; }
    .badge-low      { background: #fef9c3; color: #92400e; }

    /* ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ */
    .code-block {
      background: #1e293b;
      color: #e2e8f0;
      border-radius: 8px;
      padding: 12px 14px;
      font-family: "Consolas", monospace;
      font-size: 12px;
      line-height: 1.7;
      margin: 8px 0 4px;
      overflow-x: auto;
      white-space: pre;
    }
    code {
      background: #e2e8f0;
      color: #1e293b;
      padding: 1px 5px;
      border-radius: 4px;
      font-family: "Consolas", monospace;
      font-size: 12px;
    }

    .notice {
      background: #fff7ed;
      border-left: 3px solid #f97316;
      border-radius: 6px;
      padding: 8px 12px;
      font-size: 13px;
      color: #7c3522;
      margin: 8px 0;
      line-height: 1.7;
    }
    .notice strong { display: block; margin-bottom: 2px; }

    .info {
      background: #eff6ff;
      border-left: 3px solid #3b82f6;
      border-radius: 6px;
      padding: 8px 12px;
      font-size: 13px;
      color: #1e3a5f;
      margin: 8px 0;
      line-height: 1.7;
    }
    .info strong { display: block; margin-bottom: 2px; }

    .action-bar { text-align: right; margin-bottom: 8px; }
    .reset-btn {
      padding: 6px 16px;
      background: #e2e8f0;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      color: #555;
    }
    .reset-btn:hover { background: #cbd5e1; }

    .legend {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      margin-bottom: 20px;
      font-size: 13px;
    }
    .legend span { display: flex; align-items: center; gap: 5px; }
  </style>
</head>
<body>

<h1>çµŒè²»ç”³è«‹ã‚¢ãƒ—ãƒª ä½œæ¥­ãƒªã‚¹ãƒˆ</h1>
<p class="subtitle">æœ€çµ‚æ›´æ–°: 2026å¹´2æœˆ17æ—¥ ï¼ å…¨ä½“é€²æ— ç´„45%</p>

<!-- å…¨ä½“é€²æ— -->
<div class="overall-progress">
  <h2>å…¨ä½“é€²æ—</h2>
  <div class="progress-row">
    <span class="progress-label-text">ãƒ•ã‚§ãƒ¼ã‚º1 SharePointåŸºç›¤</span>
    <div class="progress-bar-bg"><div class="progress-bar-fill bar-done" style="width:100%"></div></div>
    <span class="progress-pct" style="color:#22c55e">100%</span>
  </div>
  <div class="progress-row">
    <span class="progress-label-text">ãƒ•ã‚§ãƒ¼ã‚º2 Power Appsä¿®æ­£</span>
    <div class="progress-bar-bg"><div class="progress-bar-fill bar-mid" id="phase2-bar" style="width:17%"></div></div>
    <span class="progress-pct" id="phase2-pct" style="color:#3b82f6">17%</span>
  </div>
  <div class="progress-row">
    <span class="progress-label-text">ãƒ•ã‚§ãƒ¼ã‚º3 Power Automate</span>
    <div class="progress-bar-bg"><div class="progress-bar-fill bar-zero"></div></div>
    <span class="progress-pct" style="color:#9ca3af">0%</span>
  </div>
  <div class="progress-row">
    <span class="progress-label-text">ãƒ•ã‚§ãƒ¼ã‚º4 ä»•ä¸Šã’</span>
    <div class="progress-bar-bg"><div class="progress-bar-fill bar-zero"></div></div>
    <span class="progress-pct" style="color:#9ca3af">0%</span>
  </div>
</div>

<div class="legend">
  <span><span class="task-badge badge-done">å®Œäº†</span> ä½œæ¥­æ¸ˆã¿</span>
  <span><span class="task-badge badge-todo">æ¬¡ã«ã‚„ã‚‹</span> æ¬¡ã®ä½œæ¥­</span>
  <span><span class="task-badge badge-low">æ¨å¥¨</span> ã‚„ã‚‹ã¨ã‚ˆã„</span>
  <span><span class="task-badge badge-optional">ä»»æ„</span> ä½™è£•ãŒã‚ã‚Œã°</span>
</div>

<div class="action-bar">
  <button class="reset-btn" onclick="resetAll()">å…¨ãƒã‚§ãƒƒã‚¯ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
</div>

<!-- ===== ãƒ•ã‚§ãƒ¼ã‚º1 ===== -->
<div class="phase phase-1">
  <div class="phase-header" onclick="togglePhase('phase1-body', this)">
    <span class="phase-icon">ğŸ—ƒï¸</span>
    <span class="phase-title">ãƒ•ã‚§ãƒ¼ã‚º1ï¼šSharePointåŸºç›¤</span>
    <span class="phase-status">å®Œäº†</span>
    <span class="phase-toggle">â–¼</span>
  </div>
  <div class="phase-body collapsed" id="phase1-body">

    <div class="task completed" id="t1-1">
      <input type="checkbox" class="task-checkbox" checked onchange="onCheck(this,'t1-1')">
      <span class="task-num">1-1</span>
      <div class="task-body">
        <div class="task-title">ExpenseRequests ãƒªã‚¹ãƒˆã®ä½œæˆ</div>
        <div class="task-desc">
          ç”³è«‹ãƒ˜ãƒƒãƒ€ãƒ¼ç”¨ã®SharePointãƒªã‚¹ãƒˆã€‚ä»¥ä¸‹ã®åˆ—ãŒã™ã¹ã¦ä½œæˆæ¸ˆã¿ã€‚<br>
          ç”³è«‹è€…ï¼ˆPersonï¼‰ãƒ»éƒ¨ç½²ãƒ»åˆè¨ˆé‡‘é¡ãƒ»æ˜ç´°ä»¶æ•°ãƒ»æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ»æ‰¿èªè€…ãƒ»æ‰¿èªæ—¥æ™‚ãƒ»æ‰¿èªã‚³ãƒ¡ãƒ³ãƒˆãªã©ã€‚<br>
          <strong>â€» ç¨åŒºåˆ†åˆ—ã¯ã€Œå‚ç…§ï¼ˆLookupï¼‰ã€å‹ â†’ TaxRatesãƒªã‚¹ãƒˆã®ã€Œç¨åŒºåˆ†ã€åˆ—ã‚’å‚ç…§ã™ã‚‹è¨­å®šæ¸ˆã¿ã€‚</strong>
        </div>
      </div>
      <span class="task-badge badge-done">å®Œäº†</span>
    </div>

    <div class="task completed" id="t1-2">
      <input type="checkbox" class="task-checkbox" checked onchange="onCheck(this,'t1-2')">
      <span class="task-num">1-2</span>
      <div class="task-body">
        <div class="task-title">ExpenseDetails ãƒªã‚¹ãƒˆã®ä½œæˆ</div>
        <div class="task-desc">
          çµŒè²»æ˜ç´°ç”¨ã®SharePointãƒªã‚¹ãƒˆã€‚çµŒè²»æ—¥ä»˜ãƒ»å‹˜å®šç§‘ç›®ãƒ»å†…å®¹ãƒ»ç¨è¾¼é‡‘é¡ãƒ»ç¨åŒºåˆ†ãƒ»ç¨é¡ãƒ»ç¨æŠœé‡‘é¡ã®åˆ—ãŒä½œæˆæ¸ˆã¿ã€‚<br>
          <strong>â€» ã€Œç”³è«‹IDã€åˆ—ã¯ãƒªã‚¹ãƒˆã«å­˜åœ¨ã—ãªã„ã€‚ã‚¿ã‚¹ã‚¯ 2-3 ã§è¿½åŠ ãŒå¿…è¦ã€‚</strong>
        </div>
      </div>
      <span class="task-badge badge-done">å®Œäº†</span>
    </div>

    <div class="task completed" id="t1-3">
      <input type="checkbox" class="task-checkbox" checked onchange="onCheck(this,'t1-3')">
      <span class="task-num">1-3</span>
      <div class="task-body">
        <div class="task-title">TaxRates ãƒªã‚¹ãƒˆã®ä½œæˆï¼ˆç¨åŒºåˆ†ãƒã‚¹ã‚¿ãƒ¼ï¼‰</div>
        <div class="task-desc">
          8ç¨®é¡ã®ç¨åŒºåˆ†ãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²æ¸ˆã¿ï¼ˆ10%/8%ã®é©æ ¼ãƒ»çµŒéæªç½®80%/50%ã€éèª²ç¨ã€ä¸èª²ç¨ï¼‰ã€‚<br>
          ExpenseRequests ã®ã€Œç¨åŒºåˆ†ã€åˆ—ãŒã“ã®ãƒªã‚¹ãƒˆã‚’å‚ç…§ï¼ˆLookupï¼‰ã—ã¦ã„ã‚‹ã€‚
        </div>
      </div>
      <span class="task-badge badge-done">å®Œäº†</span>
    </div>

    <div class="task completed" id="t1-4">
      <input type="checkbox" class="task-checkbox" checked onchange="onCheck(this,'t1-4')">
      <span class="task-num">1-4</span>
      <div class="task-body">
        <div class="task-title">Power Apps ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æ¥ç¶šï¼ˆã‚¿ã‚¹ã‚¯2-1ï¼‰</div>
        <div class="task-desc">ExpenseRequestsãƒ»ExpenseDetailsãƒ»TaxRates ã®3ãƒªã‚¹ãƒˆã‚’Power Appsã«æ¥ç¶šæ¸ˆã¿ã€‚</div>
      </div>
      <span class="task-badge badge-done">å®Œäº†</span>
    </div>

  </div>
</div>

<!-- ===== ãƒ•ã‚§ãƒ¼ã‚º2 ===== -->
<div class="phase phase-2">
  <div class="phase-header" onclick="togglePhase('phase2-body', this)">
    <span class="phase-icon">ğŸ“±</span>
    <span class="phase-title">ãƒ•ã‚§ãƒ¼ã‚º2ï¼šPower Apps ç”»é¢ä¿®æ­£</span>
    <span class="phase-status">ä½œæ¥­ä¸­</span>
    <span class="phase-toggle">â–¼</span>
  </div>
  <div class="phase-body" id="phase2-body">

    <div class="task completed" id="t2-2">
      <input type="checkbox" class="task-checkbox" checked onchange="onCheck(this,'t2-2')">
      <span class="task-num">2-2</span>
      <div class="task-body">
        <div class="task-title">DetailFormScreenï¼šç¨è¨ˆç®—ã‚¨ãƒ©ãƒ¼ã‚’ä¿®æ­£</div>
        <div class="task-desc">
          ç¨é¡ãƒ©ãƒ™ãƒ«(Label9_1)ã¨ç¨æŠœé‡‘é¡ãƒ©ãƒ™ãƒ«(Label8)ã®ã‚¨ãƒ©ãƒ¼ã‚’ä¿®æ­£æ¸ˆã¿ã€‚é‡‘é¡æ¬„(txtAmount)ãŒç©ºã®ã¨ãã«ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ã¦ã„ãŸå•é¡Œã‚’ IsBlank + IsNumeric ã®ã‚¬ãƒ¼ãƒ‰ã§è§£æ¶ˆã—ãŸã€‚
        </div>
      </div>
      <span class="task-badge badge-done">å®Œäº†</span>
    </div>

    <!-- æ–°ã‚¿ã‚¹ã‚¯2-3ï¼šç”³è«‹IDã®Lookupåˆ—è¿½åŠ  -->
    <div class="task" id="t2-3">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t2-3')">
      <span class="task-num">2-3</span>
      <div class="task-body">
        <div class="task-title">ExpenseDetails ã«ã€Œç”³è«‹IDã€Lookupåˆ—ã‚’è¿½åŠ ã™ã‚‹</div>
        <div class="task-desc">
          çµŒè²»æ˜ç´°ã‚’ç”³è«‹ãƒ˜ãƒƒãƒ€ãƒ¼ã«ç´ä»˜ã‘ã‚‹ãŸã‚ã®åˆ—ãŒç¾åœ¨ãªã„ã€‚SharePointã§ä»¥ä¸‹ã®æ‰‹é †ã‚’è¡Œã†ã€‚
          <div class="info" style="margin-top:8px;">
            <strong>æ“ä½œæ‰‹é †ï¼ˆSharePointï¼‰</strong>
            1. ExpenseDetails ãƒªã‚¹ãƒˆã‚’é–‹ã<br>
            2. å³ä¸Šã®ã€Œï¼‹åˆ—ã‚’è¿½åŠ ã€â†’ã€Œå‚ç…§ã€ã‚’é¸æŠ<br>
            3. åå‰ï¼š<code>ç”³è«‹ID</code><br>
            4. ã‚½ãƒ¼ã‚¹ãƒªã‚¹ãƒˆï¼š<code>ExpenseRequests</code><br>
            5. å‚ç…§ã™ã‚‹åˆ—ï¼š<code>ID</code>ï¼ˆã¾ãŸã¯ã€Œã‚¿ã‚¤ãƒˆãƒ«ã€ï¼‰<br>
            6. ã€Œä¿å­˜ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
          </div>
          <div class="notice" style="margin-top:8px;">
            <strong>ãªãœå¿…è¦ï¼Ÿ</strong>
            1ã¤ã®ç”³è«‹ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ï¼‰ã«è¤‡æ•°ã®çµŒè²»æ˜ç´°ã‚’ç´ä»˜ã‘ã‚‹ãŸã‚ã€‚ã“ã®åˆ—ãŒãªã„ã¨ã€Œã©ã®ç”³è«‹ã®æ˜ç´°ã‹ã€ãŒåˆ¤åˆ¥ã§ããªã„ã€‚
          </div>
        </div>
      </div>
      <span class="task-badge badge-todo">æ¬¡ã«ã‚„ã‚‹</span>
    </div>

    <!-- ã‚¿ã‚¹ã‚¯2-4ï¼šPatchå¼å®Œæˆ -->
    <div class="task" id="t2-4">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t2-4')">
      <span class="task-num">2-4</span>
      <div class="task-body">
        <div class="task-title">DetailFormScreenï¼šã€Œè¿½åŠ ã€ãƒœã‚¿ãƒ³ã®ä¿å­˜å¼ã‚’å®Œæˆã•ã›ã‚‹</div>
        <div class="task-desc">
          ã€Œè¿½åŠ ã€ãƒœã‚¿ãƒ³ï¼ˆButton1_6ï¼‰ã® OnSelect ã«ä¸‹è¨˜ã®å®Œæˆç‰ˆã®å¼ã‚’è²¼ã‚Šä»˜ã‘ã‚‹ã€‚
          <div class="notice" style="margin-top:8px;">
            <strong>å‰æï¼šã‚¿ã‚¹ã‚¯2-3 ã§ç”³è«‹IDåˆ—ã‚’è¿½åŠ ã—ã¦ã‹ã‚‰ä½œæ¥­ã™ã‚‹ã“ã¨ã€‚</strong>
          </div>
          <div class="info" style="margin-top:8px;">
            <strong>ç¨åŒºåˆ†ã«ã¤ã„ã¦ï¼ˆé‡è¦ï¼‰</strong>
            ExpenseRequests ã®ç¨åŒºåˆ†ã¯ã€Œå‚ç…§ï¼ˆLookupï¼‰å‹ã€ã§ TaxRates ã‚’å‚ç…§ã—ã¦ã„ã‚‹ã€‚<br>
            Patch ã™ã‚‹ã¨ãã¯ <code>{Id: Dropdown2.Selected.ID, Value: Dropdown2.Selected.ç¨åŒºåˆ†}</code> ã®å½¢å¼ã§æ›¸ãå¿…è¦ãŒã‚ã‚‹ï¼ˆ<code>.Value</code> ã ã‘ã§ã¯ä¿å­˜ã§ããªã„ï¼‰ã€‚
          </div>
          <div class="code-block">With(
    {
        rate: Value(Substitute(Dropdown2.Selected.ç¨ç‡, "%", "")) / 100,
        amt:  Value(txtAmount.Text)
    },
    Patch(
        ExpenseDetails,
        Defaults(ExpenseDetails),
        {
            Title:     txtContent.Text,
            'çµŒè²»æ—¥ä»˜': dpExpenseDate.SelectedDate,
            'å‹˜å®šç§‘ç›®': {Value: ddAccountItem.Selected.Value},
            'å†…å®¹':     txtContent.Text,
            'ç¨è¾¼é‡‘é¡': amt,
            'ç”³è«‹ID':  {
                Id:    varCurrentRequestID,
                Value: varCurrentRequestID
            },
            'ç¨åŒºåˆ†':  {
                Id:    Dropdown2.Selected.ID,
                Value: Dropdown2.Selected.ç¨åŒºåˆ†
            },
            'ç¨é¡':    RoundDown(amt - amt / (1 + rate), 0),
            'ç¨æŠœé‡‘é¡': RoundDown(amt / (1 + rate), 0)
        }
    )
);
Navigate(RequestFormScreen)</div>
          <div class="info" style="margin-top:8px;">
            <strong>ã‚³ãƒ¼ãƒ‰ã®èª­ã¿æ–¹ï¼ˆåˆå¿ƒè€…å‘ã‘ï¼‰</strong>
            <code>With({...}, ...)</code>ï¼šå…ˆã« rateï¼ˆç¨ç‡ï¼‰ã¨ amtï¼ˆé‡‘é¡ï¼‰ã‚’è¨ˆç®—ã—ã¦ã‹ã‚‰ Patch ã‚’å®Ÿè¡Œ<br>
            <code>Substitute(ç¨ç‡, "%", "") / 100</code>ï¼šã€Œ10.00%ã€ã¨ã„ã†æ–‡å­—ã‹ã‚‰ % ã‚’é™¤ã„ã¦ 0.10 ã«å¤‰æ›<br>
            <code>Dropdown2.Selected.ID</code>ï¼šLookup å‹ã®å‚ç…§ã«ã¯ ID ãŒå¿…è¦<br>
            <code>RoundDown(..., 0)</code>ï¼šç¨é¡ãƒ»ç¨æŠœé‡‘é¡ã‚’1å††æœªæº€åˆ‡ã‚Šæ¨ã¦
          </div>
        </div>
      </div>
      <span class="task-badge badge-todo">æ¬¡ã«ã‚„ã‚‹</span>
    </div>

    <!-- ã‚¿ã‚¹ã‚¯2-5 -->
    <div class="task" id="t2-5">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t2-5')">
      <span class="task-num">2-5</span>
      <div class="task-body">
        <div class="task-title">HomeScreenï¼š3ã¤ã®ãƒœã‚¿ãƒ³ã«å‹•ä½œã‚’è¨­å®šã™ã‚‹</div>
        <div class="task-desc">
          ãƒ›ãƒ¼ãƒ ç”»é¢ã®ãƒœã‚¿ãƒ³ã« OnSelect ã‚’è¨­å®šã™ã‚‹ã€‚ç¾åœ¨ã¯æŠ¼ã—ã¦ã‚‚ä½•ã‚‚èµ·ããªã„çŠ¶æ…‹ã€‚
          <div class="info" style="margin-top:8px;">
            <strong>å„ãƒœã‚¿ãƒ³ã® OnSelect è¨­å®šå†…å®¹</strong>
            ãƒ»æ–°è¦ç”³è«‹ãƒœã‚¿ãƒ³ï¼ˆButton1_2ï¼‰ï¼šPatch ã§ç”³è«‹ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆ â†’ RequestFormScreen ã¸ç§»å‹•<br>
            ãƒ»ç”³è«‹ä¸€è¦§ãƒœã‚¿ãƒ³ï¼ˆButton1_1ï¼‰ï¼š<code>Navigate(RequestListScreen)</code><br>
            ãƒ»æ‰¿èªç®¡ç†ãƒœã‚¿ãƒ³ï¼ˆButton1ï¼‰ï¼š<code>Navigate(ApprovalScreen)</code>
          </div>
        </div>
      </div>
      <span class="task-badge badge-todo">æ¬¡ã«ã‚„ã‚‹</span>
    </div>

    <!-- ã‚¿ã‚¹ã‚¯2-6 -->
    <div class="task" id="t2-6">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t2-6')">
      <span class="task-num">2-6</span>
      <div class="task-body">
        <div class="task-title">RequestListScreenï¼šæ–°è¦ç”³è«‹ãƒœã‚¿ãƒ³ãƒ»è¡Œã‚¿ãƒƒãƒ—ã®å‹•ä½œã‚’ç¢ºèªã™ã‚‹</div>
        <div class="task-desc">
          ç”³è«‹ä¸€è¦§ç”»é¢ã®ã€Œï¼‹æ–°è¦ç”³è«‹ã€ãƒœã‚¿ãƒ³ï¼ˆButton1_3ï¼‰ã¨ã€ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã®è¡Œã‚’ã‚¿ãƒƒãƒ—ã—ãŸã¨ãã®å‹•ä½œã‚’ç¢ºèªãƒ»ä¿®æ­£ã™ã‚‹ã€‚
        </div>
      </div>
      <span class="task-badge badge-todo">æ¬¡ã«ã‚„ã‚‹</span>
    </div>

    <!-- ã‚¿ã‚¹ã‚¯2-7 -->
    <div class="task" id="t2-7">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t2-7')">
      <span class="task-num">2-7</span>
      <div class="task-body">
        <div class="task-title">RequestFormScreenï¼šã€Œç”³è«‹ã™ã‚‹ã€ãƒœã‚¿ãƒ³ã‚’å®Œæˆã•ã›ã‚‹</div>
        <div class="task-desc">
          ã€Œç”³è«‹ã™ã‚‹ã€ãƒœã‚¿ãƒ³ï¼ˆButton1_4ï¼‰ã® OnSelect ã‚’è¨­å®šã™ã‚‹ã€‚æŠ¼ã™ã¨æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒã€Œç”³è«‹ä¸­ã€ã«å¤‰ã‚ã‚Šã€åˆè¨ˆé‡‘é¡ãƒ»æ˜ç´°ä»¶æ•°ãŒãƒ˜ãƒƒãƒ€ãƒ¼ã«æ›¸ãæˆ»ã•ã‚Œã‚‹ã€‚
          <div class="notice" style="margin-top:8px;">
            <strong>ã“ã®ãƒœã‚¿ãƒ³ãŒå®Œæˆã™ã‚‹ã¨Power Automateãƒ•ãƒ­ãƒ¼ï¼ˆãƒ•ã‚§ãƒ¼ã‚º3ï¼‰ãŒèµ·å‹•ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚</strong>
          </div>
        </div>
      </div>
      <span class="task-badge badge-todo">æ¬¡ã«ã‚„ã‚‹</span>
    </div>

    <!-- ã‚¿ã‚¹ã‚¯2-8ï¼ˆä»»æ„ï¼‰ -->
    <div class="task optional" id="t2-8">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t2-8')">
      <span class="task-num">2-8</span>
      <div class="task-body">
        <div class="task-title">éƒ¨ç½²å…¥åŠ›ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã«å¤‰æ›´ã™ã‚‹</div>
        <div class="task-desc">RequestFormScreen ã®éƒ¨ç½²æ¬„ï¼ˆTextInput1ï¼‰ã‚’ã€è‡ªç”±å…¥åŠ›ã‹ã‚‰ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã«å¤‰æ›´ã™ã‚‹ã€‚å…¥åŠ›ãƒŸã‚¹ã‚’é˜²ã’ã‚‹ã€‚å„ªå…ˆåº¦ä½ã€‚</div>
      </div>
      <span class="task-badge badge-optional">ä»»æ„</span>
    </div>

    <!-- ã‚¿ã‚¹ã‚¯2-9ï¼ˆæ¨å¥¨ï¼‰ -->
    <div class="task optional" id="t2-9">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t2-9')">
      <span class="task-num">2-9</span>
      <div class="task-body">
        <div class="task-title">ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«åã‚’æ•´ç†ã™ã‚‹</div>
        <div class="task-desc">Button1ãƒ»Label2 ãªã©ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆåã‚’ btnHomeãƒ»lblTitle ãªã©ã‚ã‹ã‚Šã‚„ã™ã„åå‰ã«å¤‰æ›´ã™ã‚‹ã€‚å¾Œã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãŒæ¥½ã«ãªã‚‹ã€‚</div>
      </div>
      <span class="task-badge badge-low">æ¨å¥¨</span>
    </div>

  </div>
</div>

<!-- ===== ãƒ•ã‚§ãƒ¼ã‚º3 ===== -->
<div class="phase phase-3">
  <div class="phase-header" onclick="togglePhase('phase3-body', this)">
    <span class="phase-icon">âš¡</span>
    <span class="phase-title">ãƒ•ã‚§ãƒ¼ã‚º3ï¼šPower Automate ãƒ•ãƒ­ãƒ¼ä½œæˆ</span>
    <span class="phase-status">æœªç€æ‰‹</span>
    <span class="phase-toggle">â–¼</span>
  </div>
  <div class="phase-body collapsed" id="phase3-body">

    <div class="task" id="t3-1">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t3-1')">
      <span class="task-num">3-1</span>
      <div class="task-body">
        <div class="task-title">ç”³è«‹è€…ã‚’è‡ªå‹•è¨­å®šã™ã‚‹ãƒ•ãƒ­ãƒ¼ã‚’ä½œã‚‹</div>
        <div class="task-desc">
          Power Apps ã‹ã‚‰ Person åˆ—ï¼ˆç”³è«‹è€…ï¼‰ã‚’ç›´æ¥æ›¸ãè¾¼ã‚€ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã‚„ã™ã„ãŸã‚ã€ãƒ•ãƒ­ãƒ¼ã§è‡ªå‹•è¨­å®šã™ã‚‹ã€‚
          <div class="info" style="margin-top:8px;">
            <strong>ãƒ•ãƒ­ãƒ¼ã®ä»•çµ„ã¿</strong>
            ãƒˆãƒªã‚¬ãƒ¼ï¼šExpenseRequests ã«æ–°è¦ã‚¢ã‚¤ãƒ†ãƒ ãŒä½œã‚‰ã‚ŒãŸã¨ã<br>
            ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼šã€Œé …ç›®ã®æ›´æ–°ã€ã§ ç”³è«‹è€… â† ç™»éŒ²è€…ã®Email ã‚’è‡ªå‹•ã‚»ãƒƒãƒˆ
          </div>
        </div>
      </div>
      <span class="task-badge badge-todo">æ¬¡ã«ã‚„ã‚‹</span>
    </div>

    <div class="task" id="t3-2">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t3-2')">
      <span class="task-num">3-2</span>
      <div class="task-body">
        <div class="task-title">æ‰¿èªè€…ã¸ã®Teamsé€šçŸ¥ãƒ•ãƒ­ãƒ¼ã‚’ä½œã‚‹</div>
        <div class="task-desc">
          æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒã€Œç”³è«‹ä¸­ã€ã«ãªã£ãŸã¨ãã€æ‰¿èªè€…ã®Teamsã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹ãƒ•ãƒ­ãƒ¼ã€‚
          <div class="info" style="margin-top:8px;">
            <strong>ãƒ•ãƒ­ãƒ¼ã®ä»•çµ„ã¿</strong>
            ãƒˆãƒªã‚¬ãƒ¼ï¼šExpenseRequests ã®ã‚¢ã‚¤ãƒ†ãƒ ãŒä½œæˆã¾ãŸã¯å¤‰æ›´ã•ã‚ŒãŸã¨ã<br>
            æ¡ä»¶ï¼šæ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ = "ç”³è«‹ä¸­" ã®ã¨ãã ã‘é€šçŸ¥ã™ã‚‹<br>
            ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼šã€Œãƒãƒ£ãƒƒãƒˆã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æŠ•ç¨¿ã€ã§æ‰¿èªè€…ã«ç”³è«‹å†…å®¹ã‚’é€ä¿¡
          </div>
        </div>
      </div>
      <span class="task-badge badge-todo">æ¬¡ã«ã‚„ã‚‹</span>
    </div>

    <div class="task" id="t3-3">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t3-3')">
      <span class="task-num">3-3</span>
      <div class="task-body">
        <div class="task-title">æ‰¿èªãƒ•ãƒ­ãƒ¼ï¼ˆæ‰¿èªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ä»˜ãï¼‰ã‚’ä½œã‚‹</div>
        <div class="task-desc">
          æ‰¿èªè€…ãŒã€Œæ‰¿èªã€ã€Œå´ä¸‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒè‡ªå‹•æ›´æ–°ã•ã‚Œç”³è«‹è€…ã«çµæœãŒé€šçŸ¥ã•ã‚Œã‚‹ãƒ•ãƒ­ãƒ¼ã€‚Power Automate ã®ã€Œæ‰¿èªã®é–‹å§‹ã¨å¾…æ©Ÿã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ã†ã€‚
        </div>
      </div>
      <span class="task-badge badge-todo">æ¬¡ã«ã‚„ã‚‹</span>
    </div>

  </div>
</div>

<!-- ===== ãƒ•ã‚§ãƒ¼ã‚º4 ===== -->
<div class="phase phase-4">
  <div class="phase-header" onclick="togglePhase('phase4-body', this)">
    <span class="phase-icon">ğŸ</span>
    <span class="phase-title">ãƒ•ã‚§ãƒ¼ã‚º4ï¼šä»•ä¸Šã’ãƒ»å…¬é–‹</span>
    <span class="phase-status">æœªç€æ‰‹</span>
    <span class="phase-toggle">â–¼</span>
  </div>
  <div class="phase-body collapsed" id="phase4-body">

    <div class="task" id="t4-1">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t4-1')">
      <span class="task-num">4-1</span>
      <div class="task-body">
        <div class="task-title">ApprovalScreenï¼ˆæ‰¿èªç”»é¢ï¼‰ã‚’å®Ÿè£…ã™ã‚‹</div>
        <div class="task-desc">ç¾åœ¨ã¯ç©ºã®ç”»é¢ã€‚æ‰¿èªè€…ãŒç”³è«‹ã‚’ä¸€è¦§ã§ç¢ºèªã—ã€æ‰¿èªãƒ»å´ä¸‹ã§ãã‚‹ç”»é¢ã‚’ä½œã‚‹ã€‚</div>
      </div>
      <span class="task-badge badge-todo">æ¬¡ã«ã‚„ã‚‹</span>
    </div>

    <div class="task" id="t4-2">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t4-2')">
      <span class="task-num">4-2</span>
      <div class="task-body">
        <div class="task-title">Approvers ãƒªã‚¹ãƒˆã‚’ä½œæˆã™ã‚‹</div>
        <div class="task-desc">æ‰¿èªè€…ã®ä¸€è¦§ã‚’ç®¡ç†ã™ã‚‹SharePointãƒªã‚¹ãƒˆã€‚å½“é¢ã¯å›ºå®šæ‰¿èªè€…ã§ã®é‹ç”¨ã§ã‚‚OKã€‚æ‰¿èªãƒ•ãƒ­ãƒ¼ã‚’æŸ”è»Ÿã«ã—ãŸã„å ´åˆã«å¿…è¦ã€‚</div>
      </div>
      <span class="task-badge badge-todo">æ¬¡ã«ã‚„ã‚‹</span>
    </div>

    <div class="task optional" id="t4-3">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t4-3')">
      <span class="task-num">4-3</span>
      <div class="task-body">
        <div class="task-title">é ˜åæ›¸ã®æ·»ä»˜æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹</div>
        <div class="task-desc">çµŒè²»æ˜ç´°ã«é ˜åæ›¸ç”»åƒãƒ»PDFã‚’æ·»ä»˜ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚SharePointã¾ãŸã¯OneDriveã«ä¿å­˜ã™ã‚‹æƒ³å®šã€‚ä½™è£•ãŒã‚ã‚Œã°å¯¾å¿œã€‚</div>
      </div>
      <span class="task-badge badge-optional">ä»»æ„</span>
    </div>

    <div class="task" id="t4-4">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t4-4')">
      <span class="task-num">4-4</span>
      <div class="task-body">
        <div class="task-title">ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ã¨å…¨ä½“ãƒ†ã‚¹ãƒˆã‚’è¡Œã†</div>
        <div class="task-desc">ExpenseDetails ã«ã‚ã‚‹6ä»¶ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ï¼ˆç”³è«‹IDãŒç©ºã§ç´ä»˜ã‘ä¸å…¨ï¼‰ã‚’å‰Šé™¤ã™ã‚‹ã€‚ãã®å¾Œã€ç”³è«‹â†’æ‰¿èªâ†’é€šçŸ¥ã®ä¸€é€£ã®æµã‚Œã‚’å®Ÿéš›ã«æ“ä½œã—ã¦ç¢ºèªã™ã‚‹ã€‚</div>
      </div>
      <span class="task-badge badge-todo">æ¬¡ã«ã‚„ã‚‹</span>
    </div>

    <div class="task" id="t4-5">
      <input type="checkbox" class="task-checkbox" onchange="onCheck(this,'t4-5')">
      <span class="task-num">4-5</span>
      <div class="task-body">
        <div class="task-title">ã‚¢ãƒ—ãƒªã‚’å…¬é–‹ãƒ»ãƒ¡ãƒ³ãƒãƒ¼ã«å…±æœ‰ã™ã‚‹</div>
        <div class="task-desc">Power Apps Studio ã‹ã‚‰ã€Œå…¬é–‹ã€ã—ã€åˆ©ç”¨ãƒ¡ãƒ³ãƒãƒ¼ã«ã‚¢ãƒ—ãƒªã‚’å…±æœ‰ã™ã‚‹ã€‚SharePointãƒªã‚¹ãƒˆã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚‚ç¢ºèªã™ã‚‹ã“ã¨ã€‚</div>
      </div>
      <span class="task-badge badge-todo">æ¬¡ã«ã‚„ã‚‹</span>
    </div>

  </div>
</div>

<script>
  function togglePhase(bodyId, headerEl) {
    const body   = document.getElementById(bodyId);
    const toggle = headerEl.querySelector('.phase-toggle');
    body.classList.toggle('collapsed');
    toggle.classList.toggle('closed');
  }

  function onCheck(cb, taskId) {
    document.getElementById(taskId).classList.toggle('completed', cb.checked);
    updatePhase2Progress();
  }

  function updatePhase2Progress() {
    const ids  = ['t2-2','t2-3','t2-4','t2-5','t2-6','t2-7'];
    const done = ids.filter(id => document.getElementById(id).classList.contains('completed')).length;
    const pct  = Math.round(done / ids.length * 100);
    document.getElementById('phase2-bar').style.width = pct + '%';
    document.getElementById('phase2-pct').textContent = pct + '%';
  }

  function resetAll() {
    if (!confirm('ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ')) return;
    document.querySelectorAll('.task-checkbox').forEach(cb => cb.checked = false);
    document.querySelectorAll('.task').forEach(t => t.classList.remove('completed'));
    ['t1-1','t1-2','t1-3','t1-4','t2-2'].forEach(id => {
      const cb = document.getElementById(id).querySelector('.task-checkbox');
      cb.checked = true;
      document.getElementById(id).classList.add('completed');
    });
    updatePhase2Progress();
  }

  updatePhase2Progress();
</script>
</body>
</html>
